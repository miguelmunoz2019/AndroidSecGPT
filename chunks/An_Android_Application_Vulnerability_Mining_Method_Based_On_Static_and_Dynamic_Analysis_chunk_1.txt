# 2020 IEEE 5th Information Technology and Mechatronics Engineering Conference (ITOEC 2020)
# An Android Application Vulnerability Mining Method Based On Static and Dynamic Analysis
Wang Chao1, Li Qun, Wang XiaoHu1, Ren TianYu1, Dong JiaHan1, Guo GuangXin, Shi EnJie1
1State Grid Beijing Electric Power Research Institute, Beijing, China
29681987@qq.com, 664668506@qq.com, w007wxh@163.com, 280284492@qq.com, 249333924@qq.com, ggxqxh@sina.com, shi_enjie@sina.com
# Abstract
Due to the advantages and limitations of the two kinds of vulnerability mining methods of static and dynamic analysis of android applications, the paper proposes a method of Android application vulnerability mining based on dynamic and static combination. Firstly, the static analysis method is used to obtain the basic vulnerability analysis results of the application, and then the input test case of dynamic analysis is constructed on this basis. The fuzzy input test is carried out in the real machine environment, and the application security vulnerability is verified with the taint analysis technology, and finally the application vulnerability report is obtained. Experimental results show that compared with static analysis results, the method can significantly improve the accuracy of vulnerability mining.

# Keyword
Android APP; Vulnerability mining; Static analysis; Dynamic analysis
# I. INTRODUCTION
In recent years, the development of applications based on Android platform has shown a trend of rapid growth, and the accompanying security issues have attracted more and more attention. Due to the lack of security awareness of developers, there are various loopholes in the program design. At the same time, the domestic Android application market is chaotic and lacks an effective unified management mechanism, the application security quality is difficult to be guaranteed, and the number of security vulnerabilities is increasing year by year.

Therefore, Android application vulnerability mining has attracted more and more attention from researchers. Generally, vulnerability mining of Android applications can be divided into static analysis and dynamic analysis. The paper performed reverse analysis on the application, statically analyzed the data flow of the application code, tracked the taint of sensitive data, obtained the propagation path of sensitive data in the application, and played a guiding role in the detection of application vulnerabilities.

# II. Vulnerability mining process
Based on the analysis of the advantages and limitations of static analysis and dynamic analysis of android applications, a vulnerability mining method based on the combination of static and dynamic analysis is proposed. This method first disassembles the code and analyzes the code, and uses type inference and type constraints to obtain test cases based on the vulnerability security rules. Then, the test cases are mutated by using the security rule base, and fuzzy test is carried out by...

978-1-7281-4323-1/20/$31 ©2020 IEEE
Authorized licensed use limited to: Pontificia Universidad Javeriana. Downloaded on August 10, 2024 at 05:47:39 UTC from IEEE Xplore. Restrictions apply.

# Vulnerability Mining Process
using the method of taint tracking. The flowchart is shown in Fig. 1.

First, the Android application is decompiled and preprocessed, and the application source file is obtained. Then, the application feature vector is obtained by feature extraction.

Finally, according to the vulnerability rule base, the static analysis results are obtained by using the scan engine for analysis and matching.

# B. Decompilation
The purpose of decompilation is to obtain the source code of the application, such as Java source code and AndroidManifest.XML. First, the APK file is decompressed to obtain AndroidManifest.AXML, DEX file, resource file, etc. Then, the dex2jar tool is used to decompile, convert the Dex file into a Jar file, and use the jd-gui tool to decompile the obtained file to obtain the application Java source code. The AndroidManifest.AXML file can be reversed to get the AndroidManifest.XML file by using the AXMLPrinter2 tool. Decompilation process is shown in Fig. 3.

# III. Static analysis
# A. Static analysis process
Android vulnerability static analysis reads and analyzes the source code of the program through automated tools to detect key points of possible security vulnerabilities in the program. The static analysis process is shown in Fig. 2.

# C. Vulnerability rule extraction
# 1) Component exposure
If the android application component is exposed, attackers can hijack its component for related operations by constructing a message object that conforms to the definition of the application component. The generation condition of component exposure is that when applying for component in the manifest file, the exported property is set to "true", or when the exported property is not set to "false", the
Authorized licensed use limited to: Pontificia Universidad Javeriana. Downloaded on August 10, 2024 at 05:47:39 UTC from IEEE Xplore. Restrictions apply.

# Application Vulnerabilities
Application sets the intent filter for the component, which may cause the component to be called by other applications. The detection of such vulnerabilities is mainly to match the feature sets such as component and permissions obtained by static analysis.

# 2) SQL Injection
It is commonly used in Web programs. Related research has found that Android applications can also introduce SQL injection vulnerabilities when executing unsafe SQL statements. Android applications commonly use SQLLite to store data. The most common SQL vulnerability is that applications use raw SQL statements to operate. When SQL statements have external input parameters, SQL injection attacks may be launched.

# 3) Webview Remote Code Execution
The addJavascriptInterface method in the Webview component is used to implement the interaction between local Java and JavaScript, but this function does not restrict the method call, which causes an attacker to call any JAVA class, and eventually causes JavaScript code to perform arbitrary attacks on the device.

# 4) Certificate Weak Check
Creation mode, which may be accessed by other applications and read and write operations may be performed, which may cause the leakage of sensitive information. It is usually necessary to avoid using the MODE_WORLD_READABLE and MODE_WORLD_WRITEABLE modes to create Shared Preferences files.

# IV. Dynamic Analysis
# A. Dynamic Analysis Process
The idea of dynamic analysis is to verify the results of vulnerability analysis based on static analysis to improve the accuracy of vulnerability mining. First, test cases are generated based on the static analysis results, and then test data is executed on the terminal where the application is installed, and taint analysis is performed to monitor the abnormal behavior of the application to obtain dynamic analysis results. The dynamic analysis process is shown in Fig. 4.

Start
Input source code
Static analysis
In the customized x509trustmanager subclass, the server-side certificate is not verified, and any server-side certificate is accepted by default, which may lead to security risks and may cause malicious programs to bypass certificate verification by using man-in-the-middle attacks.

# 5) Allow Backup Vulnerabilities
When the allow Backup property value in the AndroidManifest.xml file is set to true (the default is true), the user can back up the application data through adb backup and export the data stored in the application, causing the leakage of user data. So you need to set the android:allowBackup flag to false.

# 6) Shared Preferences Storage Risk
The Shared Preferences file does not use the correct Taint tracking.

Monitoring exception
End of output vulnerability
End
Authorized licensed use limited to: Pontificia Universidad Javeriana. Downloaded on August 10, 2024 at 05:47:39 UTC from IEEE Xplore. Restrictions apply.

# B. Taint analysis
Taint analysis is a technique for tracking and analyzing the flow of taint information in a program. In vulnerability mining, the data of user interest is first marked as tainted data. The tainted attributes of these tainted data are inherited and propagated during the execution of the program. Then, by tracking the information flow related to the tainted data, it analyzes whether these data will affect some key program operations, and then analyzes and judges whether there are program vulnerabilities.

# 1） Taint initialization
Taint initialization is mainly to mark the taint. The taint mark contains two behaviors: first, find out where the taint information is generated in the program, and second, mark the taint information. Taint identification can be achieved by monitoring specific system functions. Such as fgets(), fread(), recv(), etc. The external data obtained by these functions should be set as tainted data. Regarding tainted marks, the point where the taint information is generated is called the source point. Correspondingly, the rules for identifying source points are called source point rules.

Area or register marked as the dirty state, the dirty state of the target memory or register will be cleared. By using binary interpolation technology, before each machine instruction is executed, the actual content of each operand of the instruction is obtained, and whether it is polluted by the input data is queried. Then the corresponding operation of spreading and removing the taint is determined according to the specific type of instruction.