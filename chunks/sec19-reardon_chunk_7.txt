# Shutterfly and EXIF Metadata
We observed that the Shutterfly app (com.shutterfly) sends precise geolocation data to its own server (apcmobile.thislife.com) without holding a location permission. Instead, it sent photo metadata.

from the photo library, which included the phone’s precise location in its exchangeable image file format (EXIF) data. The app actually processed the image file: it parsed the EXIF metadata—including location—into a JSON object with labelled latitude and longitude fields and transmitted it to their server. While this app may not be intending to circumvent the permission system, this technique can be exploited by a malicious actor to gain access to the user’s location. Whenever a new picture is taken by the user with geolocation enabled, any app with read access to the photo library (i.e., READ_EXTERNAL_STORAGE) can learn the user’s precise location when said picture was taken. Furthermore, it also allows obtaining historical geolocation fixes with timestamps from the user, which could later be used to infer sensitive information about that user.

# 5 Related Work
We build on a vast literature in the field of covert- and side-channel attacks for Android. However, while prior studies generally only reported isolated instances of such attacks or approached the problem from a theoretical angle, our work combines static and dynamic analysis to automatically detect real-world instances of misbehaviours and attacks.

# Covert Channels
Marforio et al.  proposed several scenarios to transmit data between two Android apps, including the use of UNIX sockets and external storage as a shared buffer. In our work we see that the shared storage is indeed used in the wild. Other studies have focused on using mobile noises  and vibrations generated by the phone (which could be inaudible to users) as covert channels . Such attacks typically involve two physical devices communicating between themselves. This is outside of the scope of our work, as we focus on device vulnerabilities that are being exploited by apps and third parties running in user space.

# Side Channels
Spreitzer et al. provided a good classification of mobile-specific side-channels present in the literature . Previous work has demonstrated how unprivileged Android resources could be used to infer personal information about mobile users, including unique identifiers  or gender . Researchers also demonstrated that it may be possible to identify users’ locations by monitoring the power consumption of their phones  and by sensing publicly available Android resources . More recently, Zhang et al. demonstrated a sensor calibration fingerprinting attack that uses unprotected calibration data gathered from sensors like the accelerometer, gyroscope, and magnetometer . Others have shown that unprotected system-wide information is enough to infer input text in gesture-based keyboards . Research papers have also reported techniques that leverage lowly protected network information to geolocate users at the network level . We extend previous work by reporting third-party libraries and mobile applications that gain access to unique identifiers and location information in the wild by exploiting side and covert channels.

# 6 Discussion
Our work shows a number of side and covert channels that are being used by apps to circumvent the Android permissions system. The number of potential users impacted by these findings is in the hundreds of millions. In this section, we discuss how these issues are likely to defy users’ reasonable expectations, and how these behaviours may constitute violations of various laws.

We note that these exploits may not necessarily be malicious and intentional. The Shutterfly app that extracts geolocation information from EXIF metadata may not be doing this to learn location information about the user or may not be using this data later for any purpose. On the other hand, cases where an app contains both code to access the data through the permission system and code that implements an evasion do not easily admit an innocent explanation. Even less so for those containing code to legitimately access the data and then store it for others to access. This is particularly bad because covert channels can be exploited by any app that knows the protocol, not just ones sharing the same SDK. The fact that Baidu writes user’s IMEI to publicly accessible storage allows any app to access it without permission—not just other Baidu-containing apps.

# 6 Privacy Expectations
In the U.S., privacy practices are governed by the “notice and consent” framework: companies can give notice to consumers about their privacy practices (often in the form of a privacy policy), and consumers can consent to those practices by using the company’s services. While website privacy policies are canonical examples of this framework in action, the permissions system in Android (or in any other platform) is another example of the notice and consent framework, because it fulfills two purposes: (i) providing transparency into the sensitive resources to which apps request access (notice), and (ii) requiring explicit user consent before an app can access, collect, and share sensitive resources and data (consent). That apps can and do circumvent the notice and consent framework is further evidence of the framework’s failure. In practical terms, though, these app behaviours may directly lead to privacy violations because they are likely to defy consumers’ expectations.

Nissenbaum’s “Privacy as Contextual Integrity” framework defines privacy violations as data flows that defy contextual information norms . In Nissenbaum’s framework, data flows are modeled by senders, recipients, data subjects, data
types, and transmission principles in specific contexts (e.g., providing app functionality, advertising, etc.). By circumventing the permissions system, apps are able to exfiltrate data to their own servers and even third parties in ways that are likely to defy users’ expectations (and societal norms), particularly if it occurs after having just denied an app’s explicit permission request. That is, regardless of context, were a user to explicitly be asked about granting an app access to personal information and then explicitly declining, it would be reasonable to expect that the data then would not be accessible to the app. Thus, the behaviours that we document in this paper constitute clear privacy violations. From a legal and policy perspective, these practices are likely to be considered deceptive or otherwise unlawful.

Both a recent CNIL decision (France’s data protection authority), with respect to GDPR’s notice and consent requirements, and various FTC cases, with respect to unfair and deceptive practices under U.S. federal law—both described in the next section—emphasize the notice function of the Android permissions system from a consumer expectations perspective. Moreover, these issues are also at the heart of a recent complaint brought by the Los Angeles County Attorney (LACA) under the California State Unfair Competition Law. The LACA complaint was brought against a popular mobile weather app on related grounds. The case further focuses on the permissions system’s notice function, while noting that, “users have no reason to seek [geolocation data collection] information by combing through the app’s lengthy [privacy policy], buried within which are opaque discussions of [the developer’s] potential transmission of geolocation data to third parties and use for additional commercial purposes. Indeed, on information and belief, the vast majority of users do not read those sections at all”.

# 6 Legal and Policy Issues
The practices that we highlight in this paper also highlight several legal and policy issues. In the United States, for example, they may run afoul of the FTC’s prohibitions against deceptive practices and/or state laws governing unfair business practices. In the European Union, they may constitute violations of the General Data Protection Regulation (GDPR).

The Federal Trade Commission (FTC), which is charged with protecting consumer interests, has brought a number of cases under Section 5 of the Federal Trade Commission (FTC) Act  in this context. The underlying complaints have stated that circumvention of Android permissions and collection of information absent users’ consent or in a manner that is misleading is an unfair and deceptive act . One case suggested that apps requesting permissions beyond what users expect or what are needed to operate the service were found to be “unreasonable” under the FTC Act. In another case, the FTC pursued a complaint under Section 5 alleging that a mobile device manufacturer, HTC, allowed developers to collect information without obtaining users’ permission via the Android permission system, and failed to protect users from potential third-party exploitation of a related security flaw . Finally, the FTC has pursued cases involving consumer misrepresentations with respect to opt-out mechanisms from tailored advertising in mobile apps more generally.

Also in the United States, state-level Unfair and Deceptive Acts and Practices (UDAP) statutes may also apply. These typically reflect and complement the corresponding federal law. Finally, with growing regulatory and public attention to issues pertaining to data privacy and security, data collection that undermines users’ expectations and their informed consent may also be in violation of various general privacy regulations, such as the Children’s Online Privacy Protection Act (COPPA) , the recent California Privacy Protection Act (CCPA), and potentially data breach notification laws that focus on unauthorized collection, depending on the type of personal information collected.