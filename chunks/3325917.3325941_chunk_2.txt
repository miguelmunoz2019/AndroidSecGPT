Furthermore, Wang et al.  proposed DroidRisk, a quantitative method to compute the risk of Android applications and permissions. The risk score is calculated based on the potential impact as well as the type of the permission whether it is a normal permission or dangerous permission. The authors used a static weight to represent the impact of a permission based on the permission category, 1 for normal permission category and 1 for dangerous permission category. However, measuring the impact of a permission based on applied static weight is inadequate and could affect the validity of the risk score . Similarly, Dini et al.  introduced MAETROID, a framework that evaluate the applications requested permissions along with its metadata. The permission risk score is computed by assigning a static weight to each requested permission based on the permission threat category. However, the authors did not provide any empirical evaluation and analysis of their proposed framework.

In addition, Shen et al.  introduced a risk assessment model to evaluate the risk of permissions requested by an application according to the application category. The risk score is measured by calculating the number of applications requesting a specific permission within the same category over the number of applications requesting the same permission for all categories. However, the calculation of a permission risk score depends on how frequent this permission requested by other categories, which have different functionality compared to the inspected category. Consequently, a permission could have a low risk score because it was frequently requested by other categories, however, it could be risky to be granted for an application in the inspected category since the functionality of this category does not require such permission to work properly.

To overcome these limitations, PUREDroid is proposed to evaluate the risk of permissions within an application based on the application category and provide the users with a risk region for each permission to help them making the right decision whether to grant or deny the requested permission.

# 4. PROPOSED RISK ASSESSMENT MODEL
The goal of this research is to introduce a reliable method to measure the security risk of Android permissions requested by applications and the magnitude of harm resulting from granting extraneous permissions. This method can be utilized to evaluate the risk of each permission based on a constructed optimal set of permissions for each applicationâ€™s category. This section describes the proposed PUREDroid, a risk assessment model which is essential to reveal the privacy risk of an application based on its re-
quested permissions.

In order to measure the risk score of a permission in PUREDroid, the non-requested and requested permissions of applications within the same category are represented by two orthonormal states vectors |0âŸ© and |1âŸ©, respectively, as follows:
|0âŸ© = (01), |1âŸ© = (10) (1)
Every permission is characterized by how many times is requested by both benign and malware applications and represented by two vectors, |mâŸ© for malware and |nâŸ© for benign as shown in Equation 2. The components of vectors |mâŸ© and |nâŸ© are depicted on Figure 1.

|ğ‘šâŸ© = ğ›¼|0âŸ© + ğ›½|1âŸ© = (ğ›½ğ›¼), |ğ‘›âŸ© = ğ›¾|0âŸ© + ğ›¿|1âŸ© = (ğ›¿ğ›¾) (2)
The coefficients ğ›¼, ğ›½ and ğ›¾, ğ›¿ are the ğ‘¥ and ğ‘¦ components of vectors |mâŸ© and |nâŸ©, respectively. They satisfy the normalization conditions as shown in Equation 3.

ğ›¼2 + ğ›½2 = 1, ğ›¾2 + ğ›¿2 = 1 (3)
These coefficients are related to the occurrence probabilities described by the formulas in Equations 4. ğ‘ƒğ‘š is given by the ratio of the number of malware applications for a selected permission to the number of the entire malware dataset. Similarly, ğ‘ƒğ‘› is given the ratio of the number of benign applications for selected permission to the number of the entire benign dataset.

ğ›¼ = âˆš(1 âˆ’ ğ‘ƒğ‘š) ğ›½ = âˆšğ‘ƒğ‘š (4)
ğ›¾ = âˆš(1 âˆ’ ğ‘ƒğ‘›) ğ›¿ = âˆšğ‘ƒğ‘›
The vectors |mâŸ© and |nâŸ© are used to construct a risk vector based on the following steps:
First, a two dimensional vector states are extended to three dimensional vectors with the ğ‘§ component equals to zero such that
|ğ‘šâŸ© = (ğ›½), |ğ‘›âŸ© = (ğ›¿) (5)
0 0
Second, the cross product |nâŸ© Ã— |mâŸ© is computed where its ğ‘–ğ‘¡â„ component is given by
(|ğ‘›âŸ© Ã— |ğ‘šâŸ©)ğ‘– = ğœ–ğ‘–ğ‘—ğ‘˜|ğ‘›âŸ©ğ‘—|ğ‘šâŸ©ğ‘˜ (6)
Where ğœ–ğ‘–ğ‘—ğ‘˜ is commonly known as the Levi-Civita symbol and the Einstein summation convention is used. The indices ğ‘–, ğ‘—, ğ‘˜ âˆˆ {1,2,3} correspond to vector components. The only non-zero component of the cross product |nâŸ© Ã— |mâŸ© is in ğ‘§ direction, which has the following form:
(|ğ‘›âŸ© Ã— |ğ‘šâŸ©)3 = ğœ–3ğ‘—ğ‘˜|ğ‘›âŸ©ğ‘—|ğ‘šâŸ©ğ‘˜ = |ğ‘›âŸ©1|ğ‘šâŸ©2 âˆ’ |ğ‘›âŸ©2|ğ‘šâŸ©1 = ğ›¾ğ›½ âˆ’ ğ›¼ğ›¿ (7)
= âˆš(1 âˆ’ ğ‘ƒğ‘›)ğ‘ƒğ‘š âˆ’ âˆš(1 âˆ’ ğ‘ƒğ‘š)ğ‘ƒğ‘›
The cross product |nâŸ© Ã— |mâŸ© in positive direction is depicted on Figure 2.

Third, the z component of cross product can have both negative and positive values lies in the interval [âˆ’1, 1]. Therefore, the z component of |nâŸ© Ã— |mâŸ© is re-scaled to the set of values  and is used as a scaled risk measurement function ğ‘Ÿ(ğ‘ƒğ‘š, ğ‘ƒğ‘›) described by
ğ‘Ÿ(ğ‘ƒğ‘š, ğ‘ƒğ‘›) = (1+âˆš(1âˆ’ğ‘ƒğ‘›)ğ‘ƒğ‘šâˆ’âˆš(1âˆ’ğ‘ƒğ‘š)ğ‘ƒğ‘›)2 (8)
One can see that when ğ‘ƒğ‘š = 0, (i.e, a permission is not requested by any malware) the risk function is reduced to the following form:
ğ‘Ÿ(ğ‘ƒğ‘š = 0, ğ‘ƒğ‘›) = (1âˆ’âˆšğ‘ƒğ‘›)2 (9)
It is obvious that the risk function should be zero in the case when ğ‘ƒğ‘š = 0 independently of ğ‘ƒğ‘› (permission requested by benign applications). Therefore, there is a need to introduce a proper weight function ğ‘¤(ğ‘ƒğ‘›, ğ‘ƒğ‘š) defined as
ğ‘¤(ğ‘ƒ, ğ‘ƒğ‘š) =(ğ‘ƒğ‘š(ğ‘ƒğ‘š)2 ğ‘›)2+(ğ‘ƒğ‘›2) (10)
This leads to the expression for the weighted risk function R, which can be written in the following form:
ğ‘… = ğ‘¤ (1+âˆš(1âˆ’ğ‘ƒğ‘›)ğ‘ƒğ‘šâˆ’âˆš(1âˆ’ğ‘ƒğ‘š)ğ‘ƒğ‘›)2 (11)
and if ğ‘ƒğ‘š = 0, the weighted risk function R is always zero for any ğ‘ƒğ‘› > 0, as indicated previously.

The algorithm pseudo code of PUREDroid is illustrated in Algorithm 1 and the symbols used are presented in Table 1. This algorithm calculates the risk score of all permissions requested by an application A by obtaining four parameters, which are the benign applications set ğ‘†B, the malware applications set ğ‘†M, the set of permissions ğ‘†P, and the inspected application A. Next, the usage of permission ğ‘ƒi is counted and accumulated in ğ‘ƒn for benign applications and ğ‘ƒm for malware applications, which are essentially needed to compute the risk score of the permissions. After that, the risk of each permission is gauged by computing the cross product |nâŸ© Ã— |mâŸ© and re-scaled to avoid negative values. Then, the weight
is computed. Finally, the risk score R of the permission is computed by multiplying the computed weight w by the risk function r.

# Algorithm 1 Computing permission risk score R
Data: N=lScl: M-lSu|: R=0
begin
foreach permission(Pa) â‚¬ Sp do
foreach Application(A;) â‚¬ SB do Pn Pn T 1
end
foreach Application(A;) â‚¬ Su do Pm Pm + 1
end
In) x lm) (1+ln) xlm))VFPP" VFPr)P" (benign) (malware)
U' = 0 (Polz
end R = W
return R:
categories are the most targeted categories by malware according to a report from Symantec lab.

To extract all permissions within an application, each Android Application Package (.apk) of the inspected applications are analyzed through a static analysis technique. The static analysis is performed to disassemble and convert the APK contents to a readable format using apktool . Once the APK is disassembled, the information about the .apk and its AndroidMainfest.xml file is retrieved. By examining all the requested permissions by all applications within the same category, it was obvious that every category has different set of permissions. Figure 3 illustrates the number of requested permissions for every category.

After analyzing the permissions, the risk function assigned the permissions with different scores based on the number of times a permission was requested by benign and malware applications as depicted in Figure 4. The risk score can belong to one of three regions, which are Low risk region, Moderate risk region, or High risk region. These regions are introduced by the following cases:
# 5. EVALUATION AND RESULTS
PUREDroid is evaluated on a dataset obtained from AndroZoo , which is the largest publicly available benign and malware dataset for Android. After persistent effort, more than 25000 applications, including 5773 malware applications and 19242 benign applications, from AndroZoo dataset were analyzed and labeled to evaluate our distinct model. Those applications belong to seven categories, namely, Lifestyle, Music & Audio, Books & Reference, Entertainment, Tools, Education, and Photography.

These categories and the risk function ğ‘… is increasing as ğ‘ƒğ‘š is growing and for ğ‘ƒğ‘š = 1, ğ‘…ğ‘šğ‘ğ‘¥ = ğ‘…(1,0) = 1. Thus, all values of ğ‘…(ğ‘ƒğ‘š, ğ‘ƒ) âˆˆ (0] is considered as high risk region.

â€¢ Case1: When ğ‘ƒğ‘› = ğ‘ƒğ‘š , ğ‘… = 0 . For any ğ‘ƒğ‘š â‰¤ ğ‘ƒğ‘› , ğ‘…(ğ‘ƒğ‘š, ğ‘ƒ) âˆˆ [0,0] is considered as a low risk region.