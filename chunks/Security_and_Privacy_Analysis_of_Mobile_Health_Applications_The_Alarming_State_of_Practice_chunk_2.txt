Similarly, a report regarding the security and privacy issues of 43 health and fitness apps, both for iOS and Android, was presented in . The researchers found that 40% of the apps imply high risk to user’s privacy, 32% of the apps imply a medium to high risk, 28% of the apps low to medium risk whereas none of the apps was found with no risks at all. Three main technical causes of privacy risks in mobile
# A. Papageorgiou et al.: Security and Privacy Analysis of Mobile Health Applications
health and fitness apps were identified: unencrypted traffic, embedded advertisements and third-party analytics services. In another article , He et al. classified 160 m-health apps offered by Google Play to formulate a list of seven attack surfaces that need to be taken into consideration when evaluating apps’ security and privacy status: the Internet, third party services, Bluetooth, logging, SD card storage, exported components and side channels. Random samples of additional apps were tested and analyzed with respect to these seven attack surfaces, and in particular to the Internet and the third party services. According to the results, 63% of the sampled apps were sending unencrypted data over the Internet and 81% were using third party storage and hosting services such as the Amazon’s cloud services. Another study  assessed the extent to which certified m-health apps were compliant with the data protection principles mandated by the UK NHS Health Apps Library. The analysis performed on a list of 79 apps, certified by the UK NHS as clinically safe and trustworthy, showed systematic gaps in compliance with data protection principles, revealing thus security and privacy issues.

A review of 24,405 health-related apps, both for iOS (21,953) and Android (2,452) devices, was presented in . The apps have been assessed in terms of security and privacy implications based on their access to medical or other sensitive user information, their potential damage through information leaks, information manipulation or information loss, and their access to information valuable to third parties. Since the installation and testing of all the apps under review was practically infeasible, the researchers focused on the applications’ information provided by the online stores. After filtering and clustering the original sample, the results showed that 95% of the apps pose at least some potential damage through information security and privacy infringements, whereas 11% of them estimated to impose the highest potential damages.

The above studies illustrate the major concerns arising from the way each m-health app collects, manages and/or shares user’s private information. For instance, there will always be a matter of trust when an app collects more information than is needed to provide its services, thereby violating the data minimization and purpose limitation principles specified in all contemporary data protection regulations. In terms of their secure connectivity, today it is more than usual for users to interact with their apps on a not fully trusted network, i.e. at a shop or a restaurant, and therefore information leakages cannot be physically constrained to specific networks.

The work that we present in this article is an extension of the above referenced articles concerning the security and privacy assessment of m-health apps available in on-line marketplaces. In this respect, we investigate the privacy and security risks in the 20 most popular m-health apps by focusing in the area of privacy and personal data protection when sharing sensitive health information with third party entities. By evaluating how the apps request, handle and disseminate the sensitive personal information we can ultimately assess the required countermeasures for protecting it.

# III. OUR METHODOLOGY
In this section we firstly present our apps collection criteria and secondly the assessment methodology being followed for investigating the security and privacy features offered by each app. The initial tests were performed from January to February 2016 by using Android devices and apps downloaded from the official Android marketplace (i.e., Google Play). A year later, and after notifying each app’s vendor on the initially identified issues, we ran a re-evaluation process from July to August 2017, based on dynamic analysis tests, in order to verify any conformance to the previously discovered findings.

In addition to provide a bug/findings report, we performed a GDPR compliance auditing procedure to determine whether the reviewed apps conform to the new legal requirements.

# A. COLLECTION METHODOLOGY
With the aim to perform an initial screening of possible candidate applications, we collected a set of 1080 of the most popular apps from the ‘‘Medical’’ and ‘‘Health and Fitness’’ sections of Google Play. We analyzed the scope and features of each app (one by one) and, as a result, many were discarded because they did not allow any monitoring or recording of users’ biomedical data. Moreover, another large number of apps from the ‘‘Health and Fitness’’ category was also excluded because they only provided fitness-related functionalities, whereas in our research we have decided to focus on apps that provide m-health managing functionalities regarding health conditions or specific medical diseases.

To identify, collect and evaluate a manageable number of m-health apps that provide users with metrics and interventions according to their inputs, we have determined the inclusion criteria shown in Table 1. By applying the aforementioned inclusion criteria we ended up selecting 20 apps, which can be categorized into three major areas: (i) pregnancy and baby growth, (ii) personal/family members’ health agenda and symptoms assistants/checkers, (iii) blood pressure and diabetes support. Due to legal issues we cannot disclose the names (or other identifiers) of the analyzed apps. Hence, we refer to them as App. I, App. II, . . . App. XX. The number of downloads (up to 01/2016) of those apps are shown in Table 2.

# B. ASSESSMENT METHODOLOGY
The methodology adopted for assessing the 20 collected m-health apps aims at answering the following three main research questions:
# A. Papageorgiou et al.: Security and Privacy Analysis of Mobile Health Applications
- Which parties have access to personal data from the app?
- What exact data can each party access?
- How safe is each communication channel?
In order to be able to provide meaningful answers to these questions, we followed the eight steps below:
1. The first and foremost step was to register the needed personas in each app. To this end, we created fake emails and/or Facebook accounts that would allow for each app a user account to be created. Moreover, we carefully read the scope and objectives of each app to accurately emulate a typical user’s behavior.

2. After installing each application, we collected its permissions and inspected its privacy policies, if they existed on Google Play, something that became mandatory since the early 2017 by Google for the apps that request or handle sensitive user or device information.

3. This step involved automated static code analysis. To achieve this, we analyzed the APK of each app using MobSF (http://opensecurity.in/mobile-security-framework/) to detect possible vulnerabilities. Despite the fact that some of the reported issues might be considered trivial or false alarms (e.g., reports regarding the use of randomness libraries) most identified issues are rather important and they are presented in scale analysis under the corresponding section.

4. In this step we performed dynamic analysis for each app using Fiddler (https://www.telerik.com/fiddler), a well-known web debugging proxy set up. Every app was installed and tested in a cleanroom environment to achieve the most accurate results of each app’s behavior during its dynamic analysis. Moreover, we studied and manually analyzed every single communication between each app and third parties. This was achieved by intercepting all communications as illustrated in Figure 1. Additionally, we documented all the domains that the apps were communicating with and we examined their ownership status and their regulating authority. For each captured communication, we listed the type of transmitted data and we analyzed the kind of each data exchange request in terms of its encryption (plaintext vs ciphertext) and its method (e.g., GET vs POST) in order to evaluate the potential risk of exposure.

5. Once the communication channels were determined, we analyzed the web server configuration to assess the security level of the HTTPS data transmission. To accomplish this, we used a well-known free online service SSL Labs (https://www.ssllabs.com/ssltest/) from Qualys that enables the remote testing of web server’s security against a number of well-known vulnerabilities, such as Heartbleed or Drown.

6. Having an overview of the quality of each communication channel from the previous steps, we inspected each packet to determine the contents exchanged in each message. This step was essential to identify and evaluate whether the exchanged information was necessary for the intended application purpose, and what kind of data third parties may have access to.

7. In this step we summarized our findings for each app vendor and we informed them accordingly, keeping track of each response in reference to its content, response time and attitude towards changes.