In this work, we presented a solution that can reliably recognize code snippets or libraries even if obfuscation, shrinking, or similar techniques are used. By extracting fingerprints from the Abstract Syntax Tree of methods and combining them with obfuscation-resilient features of method signatures, we succeed in accurately characterizing code. We thoroughly evaluated the applicability of our technique and demonstrated that can we describe and recognize code fragments with high precision. Our solution contributes to an effective identification of problematic code in Android applications..